{"version":3,"sources":["../src/vanilla-oidc.js"],"names":["window","vanillaOidc","Oidc","userManager","state","oidcUser","init","config","UserManager","events","addUserLoaded","onUserLoaded","addSilentRenewError","onError","addUserUnloaded","onUserUnloaded","addUserSignedOut","addAccessTokenExpired","onAccessTokenExpired","document","location","toString","includes","redirect_uri","signinRedirectCallback","then","user","url","type","silent_redirect_uri","signinSilentCallback","getUser","signinSilent","error","logout","removeUserLoaded","removeSilentRenewError","removeUserUnloaded","removeUserSignedOut","removeAccessTokenExpired","signinRedirect","getUserSync"],"mappings":"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","sourcesContent":["ï»¿/* eslint-disable */\r\nwindow.vanillaOidc = (function(Oidc) {\r\n  var userManager = null;\r\n  let state = { oidcUser: null };\r\n\r\n  function init(config) {\r\n    userManager = new Oidc.UserManager(config);\r\n    var events = userManager.events;\r\n    events.addUserLoaded(onUserLoaded);\r\n    events.addSilentRenewError(onError);\r\n    events.addUserUnloaded(onUserUnloaded);\r\n    events.addUserSignedOut(onUserUnloaded);\r\n    events.addAccessTokenExpired(onAccessTokenExpired);\r\n\r\n    if (document.location.toString().includes(config.redirect_uri)) {\r\n      return userManager\r\n        .signinRedirectCallback()\r\n        .then(function(user) {\r\n          if (user.state.url) {\r\n            document.location = user.state.url;\r\n          }\r\n        })\r\n        .then(function() {\r\n          return { type: \"callback\" };\r\n        });\r\n    } else if (\r\n      document.location.toString().includes(config.silent_redirect_uri)\r\n    ) {\r\n      return userManager.signinSilentCallback().then(function() {\r\n        return { type: \"callback\" };\r\n      });\r\n    }\r\n    return userManager.getUser().then(function(user) {\r\n      state.oidcUser = user;\r\n      return { type: \"user\", user: user };\r\n    });\r\n  }\r\n\r\n  function onUserLoaded(user) {\r\n    state = {\r\n      oidcUser: user\r\n    };\r\n  }\r\n\r\n  function onUserUnloaded() {\r\n    state = {\r\n      oidcUser: null\r\n    };\r\n  }\r\n\r\n  function onAccessTokenExpired() {\r\n    state = {\r\n      oidcUser: null\r\n    };\r\n    return userManager.signinSilent();\r\n  }\r\n\r\n  function onError(error) {\r\n    state = {\r\n      error: error\r\n    };\r\n  }\r\n\r\n  var logout = function() {\r\n    state = {\r\n      oidcUser: null\r\n    };\r\n    var events = userManager.events;\r\n    events.removeUserLoaded(onUserLoaded);\r\n    events.removeSilentRenewError(onError);\r\n    events.removeUserUnloaded(onUserUnloaded);\r\n    events.removeUserSignedOut(onUserUnloaded);\r\n    events.removeAccessTokenExpired(onAccessTokenExpired);\r\n  };\r\n\r\n  function signinSilent() {\r\n    state = {\r\n      oidcUser: null\r\n    };\r\n    return userManager.signinSilent();\r\n  }\r\n\r\n  function signinRedirect(url) {\r\n    if (!url) {\r\n      url = document.location.toString();\r\n    }\r\n    return userManager.signinRedirect({\r\n      state: { url: url }\r\n    });\r\n  }\r\n\r\n  return {\r\n    state: state,\r\n    signinRedirect: signinRedirect,\r\n    signinSilent: signinSilent,\r\n    logout: logout,\r\n    init: init,\r\n    getUserSync: function() {\r\n      return state.oidcUser;\r\n    }\r\n  };\r\n})(Oidc);\r\n"],"file":"vanilla-oidc.js"}